web:
  build: .
  volumes:
    - ./{{ project_name }}:/code
  links:
   - db
   - redis
  ports:
   - 5000:5000
  command: python manage.py runserver 0.0.0.0:5000
  environment:
    AWS_ACCESS_KEY_ID: ''
    AWS_SECRET_ACCESS_KEY: ''
    AWS_STORAGE_BUCKET_NAME: ''
    AWS_S3_CUSTOM_DOMAIN: ''
    DJANGO_SETTINGS_MODULE: '{{ project_name }}.settings'
    DATABASE_URL: 'postgres://docker:docker@db_1:5432/docker'
    REDIS_URL: 'redis://redis_1:6379'
    DEBUG: 1

worker:
  build: .
  volumes:
    - ./{{ project_name }}:/code
  links:
   - db
   - redis
  command: celery -A {{ project_name }} worker -l info
  environment:
    C_FORCE_ROOT: 'True'
    AWS_ACCESS_KEY_ID: ''
    AWS_SECRET_ACCESS_KEY: ''
    AWS_STORAGE_BUCKET_NAME: ''
    AWS_S3_CUSTOM_DOMAIN: ''
    DJANGO_SETTINGS_MODULE: '{{ project_name }}.settings'
    DATABASE_URL: 'postgres://docker:docker@db_1:5432/docker'
    REDIS_URL: 'redis://redis_1:6379'
    DEBUG: 1

db:
  image: orchardup/postgresql

redis:
  image: orchardup/redis